<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Human-Like Agent Population</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 20px;
      background-color: #e5e5e5;
    }
    h1 {
      font-size: 24px;
    }
    #world {
      width: 80%;
      height: 600px;
      border: 2px solid #333;
      position: relative;
      overflow: hidden;
      background-color: #fafafa;
    }
    .agent {
      width: 20px;
      height: 20px;
      position: absolute;
      border-radius: 50%;
      background-color: blue;
      transition: all 0.1s;
    }
    .stimulus {
      width: 30px;
      height: 30px;
      position: absolute;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: white;
      text-align: center;
    }
    .banana {
      background-color: green;
    }
    .poison {
      background-color: red;
    }
  </style>
</head>
<body>
  <h1>Human-Like Virtual Population</h1>
  <div id="world"></div>

  <script>
    const world = document.getElementById('world');
    const populationSize = 100; // Number of agents
    const agents = [];
    const stimuli = [];

    const worldWidth = world.offsetWidth;
    const worldHeight = world.offsetHeight;

    // Stimuli generation (Bananas and Poison)
    function createStimulus(type) {
      const stimulus = document.createElement('div');
      stimulus.classList.add('stimulus');
      stimulus.classList.add(type);
      stimulus.textContent = type === 'banana' ? 'Banana' : 'Poison';
      stimulus.style.left = Math.random() * (worldWidth - 30) + 'px';
      stimulus.style.top = Math.random() * (worldHeight - 30) + 'px';
      world.appendChild(stimulus);
      stimuli.push(stimulus);
    }

    // Agent creation
    function createAgent() {
      const agent = document.createElement('div');
      agent.classList.add('agent');
      agent.style.left = Math.random() * (worldWidth - 20) + 'px';
      agent.style.top = Math.random() * (worldHeight - 20) + 'px';
      agent.energy = 100; // Agents start with full energy
      agent.preference = 'banana'; // Start with preference for bananas
      agent.alive = true;

      // Add learning (avoid poison after it kills)
      agent.learn = function(stimulusType) {
        if (stimulusType === 'poison' && Math.random() < 0.5) {
          agent.preference = 'banana'; // Learns to avoid poison
        }
      };

      world.appendChild(agent);
      agents.push(agent);
    }

    // Move agents and react to stimuli
    function moveAgents() {
      agents.forEach(agent => {
        if (!agent.alive) return; // Skip dead agents

        const left = parseFloat(agent.style.left);
        const top = parseFloat(agent.style.top);
        let newLeft = left + (Math.random() * 5 - 2.5); // Random small movement
        let newTop = top + (Math.random() * 5 - 2.5);

        // Boundary collision
        if (newLeft < 0) newLeft = 0;
        if (newTop < 0) newTop = 0;
        if (newLeft > worldWidth - 20) newLeft = worldWidth - 20;
        if (newTop > worldHeight - 20) newTop = worldHeight - 20;

        agent.style.left = newLeft + 'px';
        agent.style.top = newTop + 'px';

        // React to nearby stimuli
        stimuli.forEach(stimulus => {
          const distance = Math.sqrt(
            Math.pow(newLeft - parseFloat(stimulus.style.left), 2) + 
            Math.pow(newTop - parseFloat(stimulus.style.top), 2)
          );

          if (distance < 30) {
            const stimulusType = stimulus.classList.contains('banana') ? 'banana' : 'poison';

            if (agent.preference === stimulusType && agent.energy > 0) {
              // Agent eats the stimulus
              agent.energy += stimulusType === 'banana' ? 20 : -30;
              if (agent.energy <= 0) {
                agent.alive = false;
                agent.style.backgroundColor = 'gray'; // Dead agent
              }
              agent.learn(stimulusType);
              stimulus.remove(); // Remove stimulus after consumption
            }
          }
        });
      });
    }

    // Initialize world
    function initializeWorld() {
      // Create agents
      for (let i = 0; i < populationSize; i++) {
        createAgent();
      }

      // Generate stimuli (Bananas and Poisons)
      for (let i = 0; i < 10; i++) {
        createStimulus(Math.random() < 0.5 ? 'banana' : 'poison');
      }

      // Start the simulation
      setInterval(moveAgents, 100);
    }

    initializeWorld();
  </script>
</body>
</html>
